section:
  name: "Directory and File Permissions"
  description: "This section provides guidance on securing all operating system specific objects for YugabyteDB."
  number: "2"

controls:
  - id: "2.1"
    title: "Ensure the file permissions mask is correct"
    profile_applicability:
      - "Level 1 - Yugabyte"
    description: |
      Files are always created using a default set of permissions. File permissions can be
      restricted by applying a permissions mask called the umask. The yugabyte user account
      should use a umask of 077 to deny file access to all user accounts except the owner.
    rationale: |

    audit: |
      To view the mask's current setting, execute the following commands:
      # whoami
      root
      # su - yugabyte
      # whoami
      yugabyte
      # umask 0022
      The umask must be 077 or more restrictive for the yugabyte user, otherwise, this is a
      fail.
    remediation: |
      Depending upon the yugabyte user's environment, the umask is typically set in the
      initialization file .bash_profile, but may also be set in .profile or .bashrc. To set the
      umask, add the following to the appropriate profile file:
      # whoami yugabyte
      # cd ~
      # ls -ld .{bash_profile,profile,bashrc}
      ls: cannot access '.bash_profile': No such file or directory
      ls: cannot access '.profile': No such file or directory
      ls: cannot access '.bashrc': No such file or directory
      # echo "umask 077" >> .bash_profile
      # source .bash_profile
      # umask 0077
    impact: |

    default_value:
    type: "Manual"
    references:
      -
      -
    cis_controls:
      -

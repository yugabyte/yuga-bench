
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YugabyteDB CIS Benchmark Report</title>
    
    <style>
        :root {
            --yugabyte-orange: #FF6900;
            --yugabyte-dark-orange: #E55A00;
            --yugabyte-blue: #1F2F98;
            --yugabyte-light-blue: #4A90E2;
            --yugabyte-dark-blue: #0F1B5C;
            --yugabyte-black: #1A1A1A;
            --yugabyte-dark-gray: #2D2D2D;
            --yugabyte-light-gray: #F5F7FA;
            --yugabyte-border: #E1E5E9;
            --success-green: #22C55E;
            --error-red: #EF4444;
            --info-cyan: #06B6D4;
            --warning-amber: #F59E0B;
            --manual-purple: #8B5CF6;
            --manual-light-purple: #A78BFA;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: var(--yugabyte-black);
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            position: relative;
            min-height: 100vh;
        }

        .watermark {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 8rem;
            font-weight: 900;
            color: rgba(31, 47, 152, 0.05);
            z-index: 0;
            pointer-events: none;
            user-select: none;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .header {
            background: linear-gradient(135deg, var(--yugabyte-blue) 0%, var(--yugabyte-dark-blue) 50%, var(--yugabyte-orange) 100%);
            color: white;
            padding: 3rem 2rem;
            border-radius: 16px;
            margin-bottom: 2rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="white" stroke-width="0.3" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
        }

        .header > * {
            position: relative;
            z-index: 2;
        }

        .header h1 {
            font-size: 2.8rem;
            margin-bottom: 1rem;
            font-weight: 800;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            margin: 0.5rem 0;
            opacity: 0.95;
            font-size: 1.1rem;
        }

        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2.5rem;
        }

        .summary-card {
            background: white;
            padding: 2rem 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            text-align: center;
            border-left: 6px solid var(--yugabyte-blue);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .summary-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255, 105, 0, 0.05) 0%, transparent 50%);
        }

        .summary-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 25px -5px rgba(0, 0, 0, 0.15), 0 8px 10px -5px rgba(0, 0, 0, 0.1);
        }

        .summary-card.passed {
            border-left-color: var(--success-green);
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.05) 0%, white 100%);
        }
        .summary-card.failed {
            border-left-color: var(--error-red);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.05) 0%, white 100%);
        }
        .summary-card.skipped {
            border-left-color: var(--yugabyte-dark-gray);
            background: linear-gradient(135deg, rgba(45, 45, 45, 0.05) 0%, white 100%);
        }
        .summary-card.manual {
            border-left-color: var(--manual-purple);
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.05) 0%, white 100%);
        }

        .summary-card h3 {
            font-size: 3rem;
            margin-bottom: 0.5rem;
            font-weight: 800;
            position: relative;
        }

        .summary-card.passed h3 {
            color: var(--success-green);
            text-shadow: 0 2px 4px rgba(34, 197, 94, 0.2);
        }
        .summary-card.failed h3 {
            color: var(--error-red);
            text-shadow: 0 2px 4px rgba(239, 68, 68, 0.2);
        }
        .summary-card.skipped h3 {
            color: var(--yugabyte-dark-gray);
            text-shadow: 0 2px 4px rgba(45, 45, 45, 0.2);
        }
        .summary-card.manual h3 {
            color: var(--manual-purple);
            text-shadow: 0 2px 4px rgba(139, 92, 246, 0.2);
        }

        .summary-card p {
            font-weight: 600;
            color: var(--yugabyte-black);
            font-size: 1.1rem;
            position: relative;
        }

        .section-summary {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin-bottom: 2rem;
            overflow: hidden;
            border: 1px solid var(--yugabyte-border);
        }

        .section-header {
            background: linear-gradient(135deg, var(--yugabyte-light-gray) 0%, #ffffff 100%);
            padding: 1.5rem;
            border-bottom: 2px solid var(--yugabyte-orange);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .section-header:hover {
            background: linear-gradient(135deg, rgba(255, 105, 0, 0.1) 0%, #ffffff 100%);
            transform: translateX(4px);
        }

        .section-header h3 {
            margin: 0;
            font-size: 1.4rem;
            color: var(--yugabyte-blue);
            font-weight: 700;
        }

        .section-stats {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .section-stat {
            background: white;
            padding: 0.6rem 1.2rem;
            border-radius: 25px;
            font-size: 0.9rem;
            border: 2px solid var(--yugabyte-orange);
            color: var(--yugabyte-blue);
            font-weight: 600;
            box-shadow: 0 2px 4px rgba(255, 105, 0, 0.1);
        }

        .section-stat.manual {
            border-color: var(--manual-purple);
            color: var(--manual-purple);
            box-shadow: 0 2px 4px rgba(139, 92, 246, 0.1);
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: rgba(255, 105, 0, 0.2);
            border-radius: 6px;
            overflow: hidden;
            margin-top: 1rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--yugabyte-orange) 0%, var(--success-green) 100%);
            transition: width 0.5s ease;
            border-radius: 6px;
        }

        .controls-container {
            padding: 1.5rem;
            display: none;
            background: rgba(31, 47, 152, 0.02);
        }

        .controls-container.expanded {
            display: block;
        }

        .control {
            border: 1px solid var(--yugabyte-border);
            border-radius: 10px;
            margin-bottom: 1rem;
            overflow: hidden;
            transition: all 0.3s ease;
            background: white;
        }

        .control:hover {
            box-shadow: 0 8px 25px -5px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .control.pass {
            border-left: 5px solid var(--success-green);
            box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.1);
        }
        .control.fail {
            border-left: 5px solid var(--error-red);
            box-shadow: 0 0 0 1px rgba(239, 68, 68, 0.1);
        }
        .control.skip {
            border-left: 5px solid var(--yugabyte-dark-gray);
            box-shadow: 0 0 0 1px rgba(45, 45, 45, 0.1);
        }
        .control.info {
            border-left: 5px solid var(--info-cyan);
            box-shadow: 0 0 0 1px rgba(6, 182, 212, 0.1);
        }
        .control.manual {
            border-left: 5px solid var(--manual-purple);
            box-shadow: 0 0 0 1px rgba(139, 92, 246, 0.1);
        }

        .control-header {
            padding: 1.2rem 1.5rem;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8) 0%, rgba(245, 247, 250, 0.8) 100%);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .control-header:hover {
            background: linear-gradient(135deg, rgba(255, 105, 0, 0.05) 0%, rgba(245, 247, 250, 0.8) 100%);
        }

        .control-body {
            padding: 1.5rem;
            background: white;
            display: none;
            border-top: 1px solid rgba(255, 105, 0, 0.1);
        }

        .control-body.expanded {
            display: block;
        }

        .status-badge {
            display: inline-block;
            padding: 0.4rem 1rem;
            border-radius: 25px;
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-badge.PASS {
            background: linear-gradient(135deg, var(--success-green) 0%, #16a34a 100%);
            color: white;
            box-shadow: 0 2px 4px rgba(34, 197, 94, 0.3);
        }

        .status-badge.FAIL {
            background: linear-gradient(135deg, var(--error-red) 0%, #dc2626 100%);
            color: white;
            box-shadow: 0 2px 4px rgba(239, 68, 68, 0.3);
        }

        .status-badge.SKIP {
            background: linear-gradient(135deg, var(--yugabyte-dark-gray) 0%, #404040 100%);
            color: white;
            box-shadow: 0 2px 4px rgba(45, 45, 45, 0.3);
        }

        .status-badge.INFO {
            background: linear-gradient(135deg, var(--info-cyan) 0%, #0891b2 100%);
            color: white;
            box-shadow: 0 2px 4px rgba(6, 182, 212, 0.3);
        }

        .status-badge.MANUAL {
            background: linear-gradient(135deg, var(--manual-purple) 0%, #7c3aed 100%);
            color: white;
            box-shadow: 0 2px 4px rgba(139, 92, 246, 0.3);
        }

        .status-badge.WARN {
            background: linear-gradient(135deg, var(--warning-amber) 0%, #d97706 100%);
            color: white;
            box-shadow: 0 2px 4px rgba(245, 158, 11, 0.3);
        }

        .remediation {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(252, 211, 77, 0.1) 100%);
            border: 2px solid rgba(245, 158, 11, 0.2);
            padding: 1.5rem;
            border-radius: 10px;
            margin-top: 1rem;
            position: relative;
        }

        .remediation::before {
            content: '‚ö†Ô∏è';
            position: absolute;
            top: -8px;
            left: 15px;
            background: white;
            padding: 0 8px;
            font-size: 1.2rem;
        }

        .manual-verification {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(196, 181, 253, 0.1) 100%);
            border: 2px solid rgba(139, 92, 246, 0.2);
            padding: 1.5rem;
            border-radius: 10px;
            margin-top: 1rem;
            position: relative;
        }

        .manual-verification::before {
            content: 'üë§';
            position: absolute;
            top: -8px;
            left: 15px;
            background: white;
            padding: 0 8px;
            font-size: 1.2rem;
        }

        .audit-cmd {
            background: linear-gradient(135deg, var(--yugabyte-black) 0%, var(--yugabyte-dark-gray) 100%);
            color: var(--yugabyte-orange);
            border: 1px solid var(--yugabyte-orange);
            padding: 1rem;
            border-radius: 8px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9rem;
            margin: 0.5rem 0;
            overflow-x: auto;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .detail-row {
            margin: 1rem 0;
            display: flex;
            flex-wrap: wrap;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .detail-label {
            font-weight: 700;
            color: var(--yugabyte-blue);
            min-width: 120px;
            background: rgba(31, 47, 152, 0.1);
            padding: 0.3rem 0.8rem;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .chevron {
            transition: all 0.3s ease;
            color: var(--yugabyte-orange);
            font-weight: bold;
            font-size: 1.2rem;
        }

        .chevron.rotated {
            transform: rotate(90deg);
            color: var(--yugabyte-blue);
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header {
                padding: 2rem 1.5rem;
            }

            .header h1 {
                font-size: 2.2rem;
            }

            .summary-cards {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }

            .summary-card {
                padding: 1.5rem 1rem;
            }

            .summary-card h3 {
                font-size: 2.5rem;
            }

            .section-stats {
                flex-direction: column;
                gap: 0.5rem;
            }

            .watermark {
                font-size: 4rem;
            }

            .detail-row {
                flex-direction: column;
                align-items: flex-start;
            }

            .detail-label {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="watermark">YugabyteDB</div>
    <div class="container">
        
        <div class="header">
            <h1>YugabyteDB CIS Benchmark Report</h1>
            <p><strong>Profile Level:</strong> Level 1</p>
            <p><strong>Cluster:</strong> localhost:5433</p>
            <p><strong>Database:</strong> yugabyte</p>
            <p><strong>Version:</strong> PostgreSQL 15.12-YB-2.25.2.0-b0 on aarch64-unknown-linux-gnu, compiled by clang version 19.1.0 (https://github.com/yugabyte/llvm-project.git a2a6b655e14e7fa1fcf1011a6cb29cb8575249c0), 64-bit</p>
            <p><strong>Scan Time:</strong> 2025-10-03 10:21:39</p>
        </div>
        
        <div class="summary-cards">
            <div class="summary-card">
                <h3>61</h3>
                <p>Total Checks</p>
            </div>
            <div class="summary-card passed">
                <h3>20</h3>
                <p>Passed</p>
            </div>
            <div class="summary-card failed">
                <h3>12</h3>
                <p>Failed</p>
            </div>
            <div class="summary-card skipped">
                <h3>5</h3>
                <p>Skipped</p>
            </div>
            <div class="summary-card manual">
                <h3>24</h3>
                <p>Manual</p>
            </div>
        </div>
        
            <div class="section-summary">
                <div class="section-header" onclick="toggleSection(this)">
                    <h3>Access Control and Password Policies <span class="chevron">‚ñ∂</span></h3>
                    <div class="section-stats">
                        <div class="section-stat">Total: 5</div>
                        <div class="section-stat">Passed: 0</div>
                        <div class="section-stat">Failed: 0</div>
                        <div class="section-stat">Skipped: 1</div>
                        <div class="section-stat manual">Manual: 4</div>
                        <div class="section-stat">Pass Rate: 0.0%</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0.0%;"></div>
                    </div>
                </div>
                <div class="controls-container">
                    
                <div class="control skip">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>5.1: Ensure that authentication is enabled for YCQL interface of the YugabyteDB</strong>
                        </div>
                        <div>
                            <span class="status-badge SKIP">SKIP</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>‚è≥ This check has not been implemented yet.</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Run the following command to verify whether authentication is enabled on the YCQL
interface of the YugabyteDB server.
The YugabyteDB configuration files can be found in the conf directory of tarballs. For
packages, the configuration files will be located in /home/user/var/conf.
cat ts.config | grep use_cassandra_authentication
If use_cassandra_authentication is set to false, then this is a finding.
</div>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Use the yb-tserver binary and its flags to configure the YB-TServer server. Add the<br>following GFLAG to YB-TServer:<br>./bin/yb-tserver --use_cassandra_authentication=true<br>
                        </div>
                    </div>
                </div>
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>5.2: Ensure that the default password changed for the cassandra role</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Connect to YugabyteDB database via YCQL to verify whether the cassandra role has
default password.
./bin/ycqlsh -u cassandra -p cassandra
If the connection is successful this is a finding.
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Change the password for the cassandra role by issuing the following command:<br>cassandra@ycqlsh> ALTER ROLE cassandra WITH PASSWORD = 'new_password';<br>Where 'new_password' is replaced with the password of your choosing.<br>Verify the default password no longer works:<br>./bin/ycqlsh -u cassandra -p cassandra<br>Connection error:<br>... Provided username 'cassandra' and/or password are incorrect ...<br>You can now connect to the cluster using the new password:<br>./bin/ycqlsh -u cassandra -p new_password<br>
                        </div>
                    </div>
                </div>
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>5.3: Ensure the cassandra and superuser roles are separate</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">To verify the configuration, run the following query:
cassandra@ycqlsh> SELECT role FROM system_auth.roles WHERE is_superuser =
True;
role
-----------
cassandra
(1 rows)
If cassandara or any unapproved role is returned, this is a finding.
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            To remediate a misconfiguration, perform the following steps:<br>1. Execute the following command:<br>create role '<NEW_ROLE_HERE>' with password='<NEW_PASSWORD_HERE>' and<br>login=TRUE and superuser=TRUE ;<br>grant all permissions on all keyspaces to <NEW_ROLE_HERE>;<br>Note: Replace <NEW_ROLE_HERE> with the desired role and <NEW_PASSWORD_HERE><br>with a password.<br>1. Verify the new role is working.<br>2. Remove the superuser role from the cassandra account by executing the<br>following command:<br>ALTER ROLE cassandra WITH SUPERUSER=FALSE;<br>To enhance security further, disable login ability for this role by issuing the following<br>command:<br>ALTER ROLE cassandra WITH LOGIN=FALSE;<br>
                        </div>
                    </div>
                </div>
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>5.4: Ensure there are no unnecessary roles or excessive privileges</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Remove any unnecessary roles and/or permissions in accordance with organizational<br>needs.<br>Drop unnecessary roles by issuing the following command:<br>cassandra@ycqlsh> DROP ROLE IF EXISTS developer<br>Alternatively, you can revoke permissions. For example, you can revoke the<br>engineering role from the user john as follows:<br>cassandra@ycqlsh> REVOKE engineering FROM john;<br>
                        </div>
                    </div>
                </div>
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>5.5: Ensure that YCQL only listens for network connections on authorized interfaces</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Check the value of cql_proxy_bind_address in the ts.config. If
cql_proxy_bind_address is set to a non-authorized IP address or port, this is a finding.
cat ts.config | grep cql_proxy_bind_address
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Use the yb-tserver binary and its flags to configure the YB-TServer server. Add the<br>following GFLAG to YB-TServer:<br>./bin/yb-tserver --cql_proxy_bind_address <ip address>:<port><br>
                        </div>
                    </div>
                </div>
                </div>
            </div>
            <div class="section-summary">
                <div class="section-header" onclick="toggleSection(this)">
                    <h3>Connection and Login <span class="chevron">‚ñ∂</span></h3>
                    <div class="section-stats">
                        <div class="section-stat">Total: 2</div>
                        <div class="section-stat">Passed: 0</div>
                        <div class="section-stat">Failed: 0</div>
                        <div class="section-stat">Skipped: 0</div>
                        <div class="section-stat manual">Manual: 2</div>
                        <div class="section-stat">Pass Rate: 0.0%</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0.0%;"></div>
                    </div>
                </div>
                <div class="controls-container">
                    
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>6.1: Ensure login via local UNIX Domain Socket is configured correctly</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Newly created data clusters are empty of data and have two user accounts, the
superusers yugabyte and postgres. By default, the data cluster superuser is named
after the UNIX account yugabyte. Login authentication is tested via UNIX DOMAIN
SOCKETS by the UNIX user account yugabyte, the default account, and set_user has
not yet been configured:
# ./bin/yugabyte
yugabyte=#
Login attempts by another UNIX user account as the superuser should be denied:
# su - user1 # whoami user1
# ./bin/ysqlsh -U yugabyte -d yugabyte
ysqlsh: FATAL: Peer authentication failed for user "yugabyte"
# exit
This test demonstrates that not only is logging in as the superuser blocked, but so is
logging in as another user:
# su - user2 # whoami user2
# ./bin/ysqlsh -U yugabyte -d yugabyte
ysqlsh: FATAL: Peer authentication failed for user "yugabyte"
# ./bin/ysqlsh -U user1 -d yugabyte
ysqlsh: FATAL: Peer authentication failed for user "user1"
# ./bin/ysqlsh -U user2 -d yugabyte
yugabyte=#
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Creation of a database account that matches the local account allows PEER<br>authentication:<br># ./bin/ysqlsh -c "CREATE ROLE user1 WITH LOGIN;" CREATE ROLE<br>Execute the following as the UNIX user account, the default authentication rules should<br>now permit the login:<br># su - user1<br># whoami user1<br># ./bin/ysqlsh -d yugabyte<br>yugabyte=#<br>As per the host-based authentication rules in $PGDATA/pg_hba.conf, all login attempts<br>via UNIX DOMAIN SOCKETS are processed on the line beginning with local.<br>Once edited, the server process must reload the authentication file before it can take<br>effect. Improperly configured rules cannot update i.e. the old rules remain in place. The<br>YugabyteDB logs will report the outcome of the SIGHUP:<br>yugabyte=# select pg_reload_conf();<br>pg_reload_conf<br>----------------<br>t<br>(1 row)<br>Use the yb-tserver binary and its flags to configure the YB-TServer server. Add the<br>following GFLAG to YB-TServer:<br>./bin/yb-tserver --ysql_hba_conf_csv<br>
                        </div>
                    </div>
                </div>
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>6.2: Ensure login via 'host' TCP/IP Socket is configured correctly</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Confirm a login attempt has been made by looking for a logged error message detailing<br>the nature of the authenticating failure. In the case of failed login attempts, whether<br>encrypted or unencrypted, check the following:<br>‚Ä¢ The server should be sitting on a port exposed to the remote connecting host i.e.<br>NOT ip address 127.0.0.1<br>listen_addresses = '*'<br>‚Ä¢ An authenticating rule must exist in the file ysql_hba.conf<br>This example permits only encrypted sessions for the yugabyte role and denies all<br>unencrypted sessions for the yugabyte role:<br># TYPE DATABASE<br>USER<br>ADDRESS<br>METHOD<br>hostssl all<br>yugabyte<br>0.0.0.0/0<br>scram-sha-256<br>hostnossl all<br>yugabyte<br>0.0.0.0/0<br>reject<br>
                        </div>
                    </div>
                </div>
                </div>
            </div>
            <div class="section-summary">
                <div class="section-header" onclick="toggleSection(this)">
                    <h3>Directory and File Permissions <span class="chevron">‚ñ∂</span></h3>
                    <div class="section-stats">
                        <div class="section-stat">Total: 1</div>
                        <div class="section-stat">Passed: 0</div>
                        <div class="section-stat">Failed: 0</div>
                        <div class="section-stat">Skipped: 0</div>
                        <div class="section-stat manual">Manual: 1</div>
                        <div class="section-stat">Pass Rate: 0.0%</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0.0%;"></div>
                    </div>
                </div>
                <div class="controls-container">
                    
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>2.1: Ensure the file permissions mask is correct</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">To view the mask's current setting, execute the following commands:
# whoami
root
# su - yugabyte
# whoami
yugabyte
# umask 0022
The umask must be 077 or more restrictive for the yugabyte user, otherwise, this is a
fail.
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Depending upon the yugabyte user's environment, the umask is typically set in the<br>initialization file .bash_profile, but may also be set in .profile or .bashrc. To set the<br>umask, add the following to the appropriate profile file:<br># whoami yugabyte<br># cd ~<br># ls -ld .{bash_profile,profile,bashrc}<br>ls: cannot access '.bash_profile': No such file or directory<br>ls: cannot access '.profile': No such file or directory<br>ls: cannot access '.bashrc': No such file or directory<br># echo "umask 077" >> .bash_profile<br># source .bash_profile<br># umask 0077<br>
                        </div>
                    </div>
                </div>
                </div>
            </div>
            <div class="section-summary">
                <div class="section-header" onclick="toggleSection(this)">
                    <h3>Installation and Patches <span class="chevron">‚ñ∂</span></h3>
                    <div class="section-stats">
                        <div class="section-stat">Total: 8</div>
                        <div class="section-stat">Passed: 0</div>
                        <div class="section-stat">Failed: 0</div>
                        <div class="section-stat">Skipped: 4</div>
                        <div class="section-stat manual">Manual: 4</div>
                        <div class="section-stat">Pass Rate: 0.0%</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0.0%;"></div>
                    </div>
                </div>
                <div class="controls-container">
                    
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>1.1: Ensure packages are obtained from authorized repositories</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Identify and inspect configured repositories to ensure they are all valid and authorized
sources of packages. The following is an example of a simple Linux command verifying
integrity of YugabyteDB package by validating the checksum:
#!/bin/bash
# File name and URLs
FILE_NAME="yugabyte-2.20.0.0-b1-linux-x86_64.tar.gz"
FILE_URL="https://downloads.yugabyte.com/releases/2.20.0.0/$FILE_NAME"
SIGNATURE_URL="$FILE_URL.sha"
# Check if file exists locally
if [ ! -f "$FILE_NAME" ]; then
echo "File $FILE_NAME does not exist locally. Please download
installation package to proceed. Exiting."
exit 1
fi
# Compare checksums
if [ "$(wget -qO- $SIGNATURE_URL)" == "$(sha1sum $FILE_NAME | awk '{print
$1}')" ]; then
echo "Checksums match. File is verified."
else
echo "Checksums do not match. File might be corrupted or tampered with."
If the checksum of the binary packages does not match the checksum from
download.yugabyte.com, this is a fail.
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Alter the configured repositories so they only include valid and authorized sources of<br>packages.<br>#!/bin/bash<br># URL of the file to download<br>FILE_URL="https://downloads.yugabyte.com/releases/2.20.0.0/yugabyte-2.20.0.0-<br>b1-linux-x86_64.tar.gz"<br># Download the file<br>wget $FILE_URL<br>
                        </div>
                    </div>
                </div>
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>1.2: Ensure systemd Service Files Are Enabled</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">The default operating target on systemd-powered operating systems is typically "multiuser". One confirms the default target by executing the following:
$ whoami root
$ systemctl get-default multi-user.target
$ systemctl list-dependencies multi-user.target | grep -i postgres
If the intended YugabyteDB service is not registered as a dependency (or "want") of the
default target (no output for the 3rd command above), this is a fail.
/etc/systemd/system/yugabyted.service
[Unit]
Description=YugabyteDB Server
After=network.target
[Service]
User=<USERNAME>
Group=<GROUPNAME>
ExecStart=/path/to/yugabyted start --daemon=false
ExecStop=/path/to/yugabyted stop
Restart=on-failure
RestartSec=10
LimitNOFILE=4096
[Install]
WantedBy=multi-user.target
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Irrespective of package source, YugabyteDB services can be identified because it<br>typically includes the text string "yugabyted". PGDG installs do not automatically<br>register the service as a "want" of the default systemd target. Multiple instances of<br>YugabyteDB services often distinguish themselves using a version number.<br># whoami root<br># systemctl enable yugabyted<br>Created symlink /etc/systemd/system/multi-user.target.wants/yugabyted.service<br>‚Üí /usr/lib/systemd/system/yugabyted.service.<br># systemctl list-dependencies multi-user.target | grep -i yugabyted<br>‚îú‚îÄyugabyted.service<br>
                        </div>
                    </div>
                </div>
                <div class="control skip">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>1.3: Ensure Data Cluster Initialized Successfully</strong>
                        </div>
                        <div>
                            <span class="status-badge SKIP">SKIP</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>‚è≥ This check has not been implemented yet.</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Use the yb-admin binary to check the cluster status for all YB-Master servers.
.bin/yb-admin -init_master_addrs <master-ip-address:port> list_all_masters
Next, check the cluster status for all YB-TServer.
.bin/yb-admin -init_master_addrs <master ip address> list_all_tablet_servers
</div>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            In the case of a cluster initialization failure, please visit YugabyteDB Troubleshooting<br>guide: https://docs.yugabyte.com/preview/troubleshoot/<br>
                        </div>
                    </div>
                </div>
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>1.4: Ensure a separate user and group exist for YugabyteDB</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Logon to the server where YugabyteDB is installed.
To confirm existence of the group, execute the following command:
getent growd | grep yugabyte
If either the group or user do not exist, or if the user is not a member of the group, this is
a finding.
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Create a group for YugabyteDB (if it does not already exist)<br>sudo groupadd yugabyte<br>Create a user which is only used for running YugabyteDB and its related processes<br>sudo useradd -m -d /home/yugabyte -s /bin/bash -g yugabyte -u <USERID_NUMBER><br>yugabyte<br>Replacing <USERID_NUMBER> with a number not already used on the server<br>
                        </div>
                    </div>
                </div>
                <div class="control skip">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>1.5: Ensure the latest version of Python is installed</strong>
                        </div>
                        <div>
                            <span class="status-badge SKIP">SKIP</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>‚è≥ This check has not been implemented yet.</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">To verify that you have the correct version of python installed:
#!/bin/bash
# Get the Python version
PYTHON_VERSION=$(python --version 2>&1 | awk '{print $2}')
# Use sort to compare versions
if [[ $(echo -e "3.11\n$PYTHON_VERSION" | sort -V | head -n1) ==
"$PYTHON_VERSION" && "$PYTHON_VERSION" != "3.11" ]]; then
echo "This version of python ($PYTHON_VERSION) is not supported by
YugabyteDB."
exit 1
If an old/unsupported version of Python is installed this is a finding.
</div>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            1. Uninstall the old/unsupported version of Python, if present.<br>2. Download the latest compatible release of the Python:<br>www.python.org/downloads<br>3. Follow the provided installation instructions to complete the install.<br>
                        </div>
                    </div>
                </div>
                <div class="control skip">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>1.6: Ensure latest version of YugabyteDB is installed</strong>
                        </div>
                        <div>
                            <span class="status-badge SKIP">SKIP</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>‚è≥ This check has not been implemented yet.</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">To verify the version of YugabyteDB you have installed:
./bin/yugabyted version
/home/root/yugabyte-2.20.0.0/version_metadata.json
----------------------------------------------------------------------
| Version |
----------------------------------------------------------------------
| Version : 2.20.0.0-b76 |
| Build Time : 04 Nov 2023 02:23:30 UTC |
| Build Hash : 0026607ed49516b4d5770f5479dd5d60d44710af |
----------------------------------------------------------------------
If an old/unsupported version of YugabyteDB is installed this is a finding
</div>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Create a group for yugabyte (if it does not already exist)<br>sudo groupadd yugabyte<br>Create a user which is only used for running YugabyteDB and its related processes.<br>sudo groupadd -m -d <DIRECTORY_WHERE_YUGABYTEDB_INSTALLED> -s /bin/bash -g<br>yugabyte -u <USERID_NUMBER> yugabyte<br>Replacing <DIRECTORY_WHERE_YUGABYTEDB_INSTALLED with the full path of where<br>YugabyteDB binaries are installed.<br>Replacing <USERID_NUMBER> with a number not already used on the server<br>
                        </div>
                    </div>
                </div>
                <div class="control skip">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>1.7: Ensure the YugabyteDB service is run as a non-root user</strong>
                        </div>
                        <div>
                            <span class="status-badge SKIP">SKIP</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>‚è≥ This check has not been implemented yet.</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Logon to the server where YugabyteDB master service is running.
</div>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Create a group for yugabyte (if it does not already exist)<br>sudo groupadd yugabyte<br>Create a user which is only used for running YugabyteDB and its related processes.<br>sudo groupadd -m -d <DIRECTORY_WHERE_YUGABYTEDB_INSTALLED> -s /bin/bash -g<br>yugabyte -u <USERID_NUMBER> yugabyte<br>Replacing <DIRECTORY_WHERE_YUGABYTEDB_INSTALLED with the full path of where<br>YugabyteDB binaries are installed.<br>Replacing <USERID_NUMBER> with a number not already used on the server<br>
                        </div>
                    </div>
                </div>
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>1.8: Ensure clocks are synchronized on all node</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Depending on the Linux installation this may be checked by executing the following
command on each node:
ps -aef | grep ntp OR
ps -aef | grep chronyd
If NTP is not configured or clocks are out-of-sync then this is a finding.
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Install and start the time protocol on every node in the YugabyteDB cluster.<br>
                        </div>
                    </div>
                </div>
                </div>
            </div>
            <div class="section-summary">
                <div class="section-header" onclick="toggleSection(this)">
                    <h3>Logging Monitoring and Auditing <span class="chevron">‚ñ∂</span></h3>
                    <div class="section-stats">
                        <div class="section-stat">Total: 26</div>
                        <div class="section-stat">Passed: 18</div>
                        <div class="section-stat">Failed: 6</div>
                        <div class="section-stat">Skipped: 0</div>
                        <div class="section-stat manual">Manual: 2</div>
                        <div class="section-stat">Pass Rate: 75.0%</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 75.0%;"></div>
                    </div>
                </div>
                <div class="controls-container">
                    
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.1: Logging Rationale</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Not defined yet
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.2: Ensure the log destinations are set correctly</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>log_destination is properly configured: stderr</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>['stderr', 'csvlog', 'syslog']</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>stderr</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to confirm that the expected logging directory is  specified:

yugabyte=# SHOW log_destination;
 log_destination
-----------------
 stderr
(1 row)

The log destinations should comply with your organization's policies on logging. If all the  expected log destinations are not set, this is a fail.
</div>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.3: Ensure the filename pattern for log files is set correctly</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Log filename pattern includes time-based rotation: postgresql-%Y-%m-%d_%H%M%S.log</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>Time-based rotation pattern</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>postgresql-%Y-%m-%d_%H%M%S.log</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to confirm that the desired pattern is set:
yugabyte=# show log_filename;
log_filename
--------------------------------
postgresql-%Y-%m-%d_%H%M%S.log
(1 row)
Note: This example shows the use of the strftime %a escape. This creates seven log
files, one for each day of the week (e.g. postgresql-Mon.log, postgresql-Tue.log, et al).
</div>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.4: Ensure the log file permissions are set correctly</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Log file permissions are correctly set: 0600</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>0600</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>0600</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to verify that the setting is consistent with
organizational logging policy:
yugabyte=# show log_file_mode;
log_file_mode
---------------
0600
(1 row)
</div>
                        </div>
                    </div>
                </div>
                <div class="control fail">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.5: Ensure 'log_truncate_on_rotation' is enabled</strong>
                        </div>
                        <div>
                            <span class="status-badge FAIL">FAIL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Log truncate on rotation is disabled: off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>on</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to verify how log_truncate_on_rotation is set:
yugabyte=# show log_truncate_on_rotation;
log_truncate_on_rotation
--------------------------
off
(1 row)
If it is not set to on, this is a fail (depending on your organization's logging policy).
</div>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Use the yb-tserver binary and its flags to configure the YB-TServer server. Add the<br>following GFLAG to YB-TServer:<br><br>./bin/yb-tserver --ysql_pg_conf_csv=‚Äúlog_truncate_on_rotation='on'‚Äù<br>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.6: Ensure the maximum log file lifetime is set correctly</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Log rotation age is configured: 1d</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>Non-zero rotation age</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>1d</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to verify the log rotation age is set to an
acceptable value:
yugabyte=# show log_rotation_age;
log_rotation_age
------------------
1d
(1 row)
</div>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.7: Ensure the maximum log file size is set correctly</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Log rotation size is configured: 10MB</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>Non-zero rotation size</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>10MB</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to verify that log_rotation_size is set in
compliance with the organization's logging policy:
yugabyte=# show log_rotation_size;
log_rotation_size
-------------------
10MB
(1 row)
</div>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.8: Ensure the correct syslog facility is selected</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>syslog_facility is properly configured: local0</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>['local0', 'local1', 'local2', 'local3', 'local4', 'local5', 'local6', 'local7']</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>local0</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement and verify that the correct facility is selected:
yugabyte=# show syslog_facility;
syslog_facility
-----------------
local0
(1 row)
</div>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.9: Ensure syslog messages are not suppressed</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Syslog sequence numbers are enabled - messages will not be suppressed</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>on</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>on</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement and confirm that the syslog_sequence_numbers
is enabled (on):
yugabyte=# show syslog_sequence_numbers;
syslog_sequence_numbers
-------------------------
on
(1 row)
</div>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.10: Ensure syslog messages are not lost due to size</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Syslog message splitting is enabled - long messages will not be lost</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>on</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>on</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to confirm that long log messages are split when
logging to Syslog:
yugabyte=# show syslog_split_messages;
syslog_split_messages
-----------------------
on
(1 row)
</div>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.11: Ensure the program name for YugabyteDB syslog messages is correct</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Syslog identifier is properly set: postgres</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>Descriptive database identifier</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>postgres</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to verify the program name is set correctly:
yugabyte=# show syslog_ident;
syslog_ident
--------------
postgres
(1 row)
</div>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.12: Ensure the correct messages are written to the server log </strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Log minimum messages correctly set: warning</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>warning</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>warning</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to confirm the setting is correct:
yugabyte=# show log_min_messages;
log_min_messages
------------------
warning
(1 row)
</div>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.13: Ensure the correct YSQL statements generating errors are recorded</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Error statement logging properly configured: error</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>error or higher</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>error</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to verify the setting is correct:
yugabyte=# show log_min_error_statement;
log_min_error_statement
-------------------------
error
(1 row)
If not configured to at least ERROR, this is a fail.
</div>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.14: Ensure 'debug_print_parse' is disabled</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Debug print parse correctly disabled</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to confirm the setting is correct:
yugabyte=# show debug_print_parse;
debug_print_parse
-------------------
off
(1 row)
If not configured to off, this is a fail.
</div>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.15: Ensure 'debug_print_rewritten' is disabled</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Debug print rewritten correctly disabled</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to confirm the setting is disabled:
yugabyte=# show debug_print_rewritten;
debug_print_rewritten
-----------------------
off
(1 row)
If not configured to off, this is a fail.
</div>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.16: Ensure 'debug_print_plan' is disabled</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Debug print plan correctly disabled</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to verify the setting is disabled:
yugabyte=# show debug_print_plan;
debug_print_plan
------------------
off
(1 row)
If not configured to off, this is a fail.
</div>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.17: Ensure 'debug_pretty_print' is enabled</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Debug pretty print correctly enabled</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>on</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>on</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to confirm the setting is enabled:
yugabyte=# show debug_pretty_print;
debug_pretty_print
--------------------
on
(1 row)
If not configured to on, this is a fail.
</div>
                        </div>
                    </div>
                </div>
                <div class="control fail">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.18: Ensure 'log_connections' is enabled</strong>
                        </div>
                        <div>
                            <span class="status-badge FAIL">FAIL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Connection logging is not enabled: off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>on</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to verify the setting is enabled:
yugabyte=# show log_connections;
log_connections
-----------------
off
(1 row)
If not configured to on, this is a fail.
</div>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Use the yb-tserver binary and its flags to configure the YB-TServer server. Add the<br>following GFLAG to YB-TServer:<br><br>./bin/yb-tserver --ysql_pg_conf_csv=‚Äúlog_filename="log_connections='on'"<br>
                        </div>
                    </div>
                </div>
                <div class="control fail">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.19: Ensure 'log_disconnections' is enabled</strong>
                        </div>
                        <div>
                            <span class="status-badge FAIL">FAIL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Disconnection logging is not enabled: off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>on</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to verify the setting is enabled:
yugabyte=# show log_disconnections;
log_disconnections
--------------------
off
(1 row)
If not configured to on, this is a fail.
</div>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Use the yb-tserver binary and its flags to configure the YB-TServer server. Add the<br>following GFLAG to YB-TServer:<br><br>./bin/yb-tserver --ysql_pg_conf_csv="log_disconnections='on'"<br>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.20: Ensure 'log_error_verbosity' is set correctly</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Log error verbosity correctly set to verbose</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>verbose</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>default</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to verify the setting is correct:
yugabyte=# show log_error_verbosity;
log_error_verbosity
---------------------
default
(1 row)
If not configured to verbose, this is a fail.
</div>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.21: Ensure 'log_hostname' is set correctly</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Log hostname correctly disabled</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to verify the setting is correct:
yugabyte=# show log_hostname;
log_hostname
--------------
off
(1 row)
If not configured to off, this is a fail.
</div>
                        </div>
                    </div>
                </div>
                <div class="control fail">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.22: Ensure 'log_line_prefix' is set correctly</strong>
                        </div>
                        <div>
                            <span class="status-badge FAIL">FAIL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>log_line_prefix missing required components: %l (session line number), %d (database name), %u (user name), %a (application name), %h (remote host)</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>%m [%p]: [%l-1] db=%d,user=%u,app=%a,client=%h (minimum)</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>%m [%p] </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to verify the setting is correct:
yugabyte=# show log_line_prefix;
log_line_prefix
-----------------
%m [%p]
(1 row)
If the prefix does not at a minimum include %m [%p]: [%l-1]
db=%d,user=%u,app=%a,client=%h, this is a fail.
</div>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Use the yb-tserver binary and its flags to configure the YB-TServer server. Add the<br>following GFLAG to YB-TServer:<br><br>./bin/yb-tserver --ysql_pg_conf_csv="log_line_prefix=‚Äô%m [%p]: [%l-1]‚Äô"<br>
                        </div>
                    </div>
                </div>
                <div class="control fail">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.23: Ensure 'log_statement' is set correctly</strong>
                        </div>
                        <div>
                            <span class="status-badge FAIL">FAIL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Statement logging is disabled - security risk</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>ddl, mod, or all</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>none</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to verify the setting is correct:
yugabyte=# show log_statement;
log_statement
---------------
none
(1 row)
If log_statement is set to none then this is a fail.
</div>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Use the yb-tserver binary and its flags to configure the YB-TServer server. Add the<br>following GFLAG to YB-TServer:<br><br>./bin/yb-tserver --ysql_pg_conf_csv="log_line_prefix=‚Äô%m [%p]: [%l-1]‚Äô"<br>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.1.24: Ensure 'log_timezone' is set correctly</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Log timezone properly set: UTC</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>UTC or GMT</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>UTC</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement:
yugabyte=# show log_timezone;
log_timezone
--------------
UTC
(1 row)
If log_timezone is not set to GMT, UTC, or as defined by your organization's logging policy
this is a fail.
</div>
                        </div>
                    </div>
                </div>
                <div class="control fail">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.2: Ensure the YugbayteDB Audit Extension (pgAudit) is enabled</strong>
                        </div>
                        <div>
                            <span class="status-badge FAIL">FAIL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>pgAudit is loaded but no audit components are enabled</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>Audit components enabled (READ,WRITE,FUNCTION,ROLE,DDL,MISC)</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>pgaudit.log = none</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to verify pgAudit is enabled:
yugabyte=# show shared_preload_libraries ;
shared_preload_libraries
-------------------------------------------------------
pg_stat_statements,yb_pg_metrics,pgaudit,pg_hint_plan
(1 row)
If the output does not contain pgaudit, this is a fail.
Next, verify that desired auditing components are enabled:
yugabyte=# show pgaudit.log;
pgaudit.log
-------------
none
(1 row)
If the output does not contain the desired auditing components, this is a fail.
The list below summarizes pgAudit.log components:
READ: SELECT and COPY when the source is a relation or a query.
WRITE: INSERT, UPDATE, DELETE, TRUNCATE, and COPY when the destination is a relation.
FUNCTION: Function calls and DO blocks.
ROLE: Statements related to roles and privileges: GRANT, REVOKE, CREATE/ALTER/DROP
ROLE.
DDL: All DDL that is not included in the ROLE class.
MISC: Miscellaneous commands, e.g. DISCARD, FETCH, CHECKPOINT, VACUUM.
</div>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            After configuring the YB-TServer and starting the cluster, create the pgAudit extension<br>by executing the following YSQL statement:<br>yugabyte=# CREATE EXTENSION IF NOT EXISTS pgaudit;<br>CREATE EXTENSION<br>You only need to run this statement on a single node, and it will apply across your<br>cluster.<br>Use the following steps to configure audit logging in a YugabyteDB cluster with bare<br>minimum configurations.<br>Use the yb-tserver binary and its flags to configure the YB-TServer server. Add the<br>following GFLAG to YB-TServer:<br>./bin/yb-tserver --<br>ysql_pg_conf_csv="pgaudit.log='DDL',pgaudit.log_level=notice,pgaudit.log_clie<br>nt=ON"<br>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Impact:</span>
                            <span>Depending on settings, it is possible for pgAudit to generate an enormous volume of
logging. Be careful to determine exactly what needs to be audit logged in your
environment to avoid logging too much.
</span>
                        </div>
                    </div>
                </div>
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>3.3: Ensure that auditing is enabled for YCQL</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Run the following command to verify whether auditing is enabled on the YCQL interface
of the YugabyteDB server.
cat ts.config | grep ycql_enable_audit_log
If not configured to true, this is a fail.
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Use the yb-tserver binary and its flags to configure the YB-TServer server. Add the<br>following GFLAG to YB-TServer:<br><br>./bin/yb-tserver <options> --ycql_enable_audit_log=true<br>
                        </div>
                    </div>
                </div>
                </div>
            </div>
            <div class="section-summary">
                <div class="section-header" onclick="toggleSection(this)">
                    <h3>Special Configuration Considerations <span class="chevron">‚ñ∂</span></h3>
                    <div class="section-stats">
                        <div class="section-stat">Total: 4</div>
                        <div class="section-stat">Passed: 1</div>
                        <div class="section-stat">Failed: 2</div>
                        <div class="section-stat">Skipped: 0</div>
                        <div class="section-stat manual">Manual: 1</div>
                        <div class="section-stat">Pass Rate: 33.3%</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 33.33333333333333%;"></div>
                    </div>
                </div>
                <div class="controls-container">
                    
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>8.1: Ensure base backups are configured and functional</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Verify snapshots exist by executing the list_snapshots command, as follows:
./bin/yb-admin -master_addresses <ip1:7100,ip2:7100,ip3:7100> list_snapshots
All the snapshots in the cluster are listed, along with their statuses.
Snapshot UUID State Creation Time
0d4b4935-2c95-4523-95ab-9ead1e95e794 COMPLETE 2023-04-20
00:20:38.214201
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Using distributed snapshots allows you to back up a database and then restore it in<br>case of a software or operational error, with minimal recovery time objectives (RTO) and<br>overhead.<br>To back up a database, create a snapshot using the create_database_snapshot<br>command, as follows:<br>./bin/yb-admin -master_addresses <ip1:7100,ip2:7100,ip3:7100><br>create_database_snapshot ysql.<database_name><br>A unique ID for the snapshot is returned, as shown in the following sample output:<br>Started snapshot creation: 0d4b4935-2c95-4523-95ab-9ead1e95e794<br>You can then use this ID to check the status of the snapshot, delete it, or use it to<br>restore the database.<br>The create_database_snapshot command exits immediately, but the snapshot may take<br>some time to complete. Before using the snapshot, verify its status by executing the<br>list_snapshots command, as follows:<br>./bin/yb-admin -master_addresses <ip1:7100,ip2:7100,ip3:7100> list_snapshots<br>All the snapshots in the cluster are listed, along with their statuses<br>
                        </div>
                    </div>
                </div>
                <div class="control fail">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>8.2: Ensure YugabyteDB configuration files are outside the data cluster</strong>
                        </div>
                        <div>
                            <span class="status-badge FAIL">FAIL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Critical configuration files are inside data directory: config_file: /home/yugabyte/yb_data/data/pg_data/ysql_pg.conf; hba_file: /home/yugabyte/yb_data/data/pg_data/ysql_hba.conf; ident_file: /home/yugabyte/yb_data/data/pg_data/ysql_ident.conf</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>Configuration files outside data cluster directory</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>data_directory: /home/yugabyte/yb_data/data/pg_data; Inside data dir: 3</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following commands to verify the configuration is correct:
yugabyte=# select name, setting from pg_settings where name ~ '.*_file$';
name | setting
--------------------+--------------------------------------------------------
-
config_file | /home/user/var/data/pg_data/ysql_pg.conf
external_pid_file |
hba_file | /home/user/var/data/pg_data/ysql_hba.conf
ident_file | /home/user/var/data/pg_data/pg_ident.conf
ssl_ca_file |
ssl_cert_file | server.crt
ssl_crl_file |
ssl_dh_params_file |
ssl_key_file | server.key
(9 rows)
</div>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Follow these steps to remediate the configuration file locations and permissions:<br>‚Ä¢ Determine appropriate locations for relocatable configuration files based on your<br>organization's security policies. If necessary, relocate and/or rename<br>configuration files outside of the data cluster.<br>‚Ä¢ Ensure their file permissions are restricted as much as possible, i.e. only<br>superuser read access.<br>‚Ä¢ Change the settings accordingly in the ysql_pg.conf configuration file via<br>GFLAGs.<br>‚Ä¢ Restart the database cluster for the changes to take effect.<br>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>8.3: Ensure YugabyteDB subdirectory locations are outside the data cluster</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Subdirectories are located outside data cluster: log_directory: /home/yugabyte/yb_data/data/yb-data/tserver/logs. NOTE: Manual verification of file/directory permissions still required (only superusers should have access).</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>Subdirectories outside data cluster with restrictive permissions</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>data_directory: /home/yugabyte/yb_data/data/pg_data; Outside: 1 dirs</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to verify the configuration is correct.
Alternatively, inspect the parameter settings in the ysql_pg.conf configuration file.
yugabyte=# select name, setting from pg_settings where (name ~
'_directory$');
name | setting
----------------------+------------------------------------------------------
--
data_directory | /home/user/var/data/pg_data
default_tablespace |
log_directory | /home/user/var/data/yb-data/tserver/logs
stats_temp_directory | pg_stat_tmp
temp_tablespaces |
(5 rows)
Inspect the file and directory permissions for all returned values. Only superusers and
authorized users should have access control rights for these files and directories. If
permissions are not highly restrictive, this is a fail.
</div>
                        </div>
                    </div>
                </div>
                <div class="control fail">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>8.4: Ensure miscellaneous configuration settings are correct</strong>
                        </div>
                        <div>
                            <span class="status-badge FAIL">FAIL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Security concerns found: unix_socket_directories: /tmp/.yb.yugabyte01:5433 (world-writable directory - potential security risk). Manual verification of file/directory permissions required (only superusers should have access).</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>Secure configuration with restrictive permissions</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>Secure: 5 settings; Concerns: 1 settings; Settings: dynamic_library_path=$libdir; external_pid_file=; local_preload_libraries=; session_preload_libraries=; shared_preload_libraries=pg_stat_statements,yb_pg_metrics,pgaudit,pg_hint_plan; unix_socket_directories=/tmp/.yb.yugabyte01:5433</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Execute the following YSQL statement to verify the configuration is correct.
Alternatively, inspect the parameter settings in the ysql_pg.conf configuration file.
yugabyte=# select name, setting from pg_settings where name in
('external_pid_file',
'unix_socket_directories','shared_preload_libraries','dynamic_library_path','
local_preload_libraries','session_preload_libraries');
name | setting
---------------------------+-------------------------------------------------
------
dynamic_library_path | $libdir
external_pid_file |
local_preload_libraries |
session_preload_libraries |
shared_preload_libraries |
pg_stat_statements,yb_pg_metrics,pgaudit,pg_hint_plan
unix_socket_directories | /tmp/
(6 rows)
Inspect the file and directory permissions for all returned values. Only superusers
should have access control rights for these files and directories. If permissions are not
highly restricted, this is a fail.
</div>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Follow these steps to remediate the configuration:<br>‚Ä¢ Determine permissions based on your organization's security policies.<br>‚Ä¢ Relocate all files and ensure their permissions are restricted as much as<br>possible, i.e. only superuser read access.<br>‚Ä¢ Ensure all directories where these files are located have restricted permissions<br>such that the superuser can read but not write.<br>‚Ä¢ Lastly, change the settings accordingly in the ysql_pg.conf via GFLAGs and<br>restart the database cluster for changes to take effect.<br>
                        </div>
                    </div>
                </div>
                </div>
            </div>
            <div class="section-summary">
                <div class="section-header" onclick="toggleSection(this)">
                    <h3>User Access and Authorization <span class="chevron">‚ñ∂</span></h3>
                    <div class="section-stats">
                        <div class="section-stat">Total: 6</div>
                        <div class="section-stat">Passed: 1</div>
                        <div class="section-stat">Failed: 0</div>
                        <div class="section-stat">Skipped: 0</div>
                        <div class="section-stat manual">Manual: 5</div>
                        <div class="section-stat">Pass Rate: 100.0%</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 100.0%;"></div>
                    </div>
                </div>
                <div class="controls-container">
                    
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>4.1: Ensure sudo is configured correctly</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Log in as an Operating System user authorized to escalate privileges and test the sudo
invocation by executing the following:
whoami user1
# groups user1
# sudo su - yugabyte
[sudo] password for user1:
user1 is not in the sudoers file. This incident will be reported.
As shown above, user1 has not been added to the /etc/sudoers file or made a member
of any group listed in the /etc/sudoers file. Whereas:
# whoami user2
# groups user2 dba
# sudo su - yugabyte [sudo] password for user2:
# whoami
yugabyte
This shows that the user2 user is configured properly for sudo access by being a
member of the dba group.
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            As superuser root, execute the following commands:<br># echo '%dba ALL= /bin/su - yugabyte' > /etc/sudoers.d/yugabyte<br># chmod 600 /etc/sudoers.d/yugabyte<br>This grants any Operating System user that is a member of the dba group to use sudo<br>su - yugabyte to become the yugabyte user.<br>Ensure that all Operating System user's that need such access are members of the<br>group.<br>
                        </div>
                    </div>
                </div>
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>4.2: Ensure excessive administrative privileges are revoked</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            If any regular or application users have been granted excessive administrative rights,<br>those privileges should be removed immediately via the Yugabyte ALTER ROLE YSQL<br>command. Using the same example above, the following YSQL statements revoke all<br>unnecessary elevated administrative privileges from the regular user appuser:<br># whoami<br>yugabyte<br># ysqlsh -c "ALTER ROLE appuser NOSUPERUSER;" ALTER ROLE<br># ysqlsh -c "ALTER ROLE appuser NOCREATEROLE;" ALTER ROLE<br># ysqlsh -c "ALTER ROLE appuser NOCREATEDB;" ALTER ROLE<br># ysqlsh -c "ALTER ROLE appuser NOREPLICATION;" ALTER ROLE<br># ysqlsh -c "ALTER ROLE appuser NOBYPASSRLS;" ALTER ROLE<br># ysqlsh -c "ALTER ROLE appuser NOINHERIT;" ALTER ROLE<br>Verify the appuser now passes your check by having no defined Attributes:<br># whoami<br>yugabyte<br># ysqlsh -c "\du appuser"<br>List of roles<br>Role name | Attributes | Member of<br>+ + appuser | | {}<br>
                        </div>
                    </div>
                </div>
                <div class="control pass">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>4.3: Ensure excessive function privileges are revoked</strong>
                        </div>
                        <div>
                            <span class="status-badge PASS">PASS</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Roles are being used for privilege management: 15 roles, 2 users</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>Use of roles for privilege management</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>15 roles, 2 users</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Functions in YugabyteDB can be created with the SECURITY DEFINER option. When
SECURITY DEFINER functions are executed by a user, said function is run with the
privileges of the user who created it, not the user who is running it.
To list all functions that have SECURITY DEFINER, run the following YSQL:
# whoami root
# sudo su - yugabyte
# ysqlsh -c "SELECT nspname, proname, proargtypes, prosecdef, rolname,
proconfig FROM pg_proc p JOIN pg_namespace n ON p.pronamespace = n.oid JOIN
pg_authid a ON a.oid = p.proowner WHERE prosecdef OR NOT proconfig IS NULL;"
In the query results, a prosecdef value of 't' on a row indicates that that function uses
privilege elevation.
If elevation privileges are utilized which are not required or are expressly forbidden by
organizational guidance, this is a fail.
</div>
                        </div>
                    </div>
                </div>
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>4.4: Ensure excessive DML privileges are revoked</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            If a given database user has been granted excessive DML privileges for a given<br>database table, those privileges should be revoked immediately using the REVOKE<br>YSQL command.<br>Continuing with the example above, remove unauthorized grants for appreader user<br>using the REVOKE statement and verify the Boolean values are now false.<br>yugabyte=# REVOKE INSERT, UPDATE, DELETE ON TABLE customer FROM appreader;<br>REVOKE<br>
                        </div>
                    </div>
                </div>
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>4.5: Ensure Row Level Security (RLS) is configured correctly</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            In this example, we are using the using the example passwd table. We will create three<br>database roles to illustrate the workings of RLS:<br>yugabyte=# CREATE ROLE admin; CREATE ROLE<br>yugabyte=# CREATE ROLE bob; CREATE ROLE<br>yugabyte=# CREATE ROLE alice; CREATE ROLE<br>Now, we will insert known data into the passwd table:<br>yugabyte=# INSERT INTO passwd VALUES<br>('admin','xxx',0,0,'Admin','111-222-3333',null,'/root','/bin/dash');<br>INSERT 0 1<br>yugabyte=# INSERT INTO passwd VALUES<br>('bob','xxx',1,1,'Bob','123-456-7890',null,'/home/bob','/bin/zsh');<br>INSERT 0 1<br>yugabyte=# INSERT INTO passwd VALUES<br>('alice','xxx',2,1,'Alice','098-765-4321',null,'/home/alice','/bin/zsh');<br>INSERT 0 1<br>And we will enable RLS on the table:<br>yugabyte=# ALTER TABLE passwd ENABLE ROW LEVEL SECURITY; ALTER TABLE<br>Now that RLS is enabled, we need to define one or more policies. Create the<br>administrator policy and allow it access to all rows:<br>yugabyte=# CREATE POLICY admin_all ON passwd TO admin USING (true) WITH CHECK<br>(true);<br>CREATE POLICY<br>Create a policy for normal users to view all rows:<br>yugabyte=# CREATE POLICY all_view ON passwd FOR SELECT USING (true); CREATE<br>POLICY<br>Create a policy for normal users that allows them to update only their own rows and to<br>limit what values can be set for their login shell:<br>yugabyte=# CREATE POLICY user_mod ON passwd FOR UPDATE USING (current_user =<br>user_name)<br>WITH CHECK (<br>current_user = user_name AND<br>shell IN ('/bin/bash','/bin/sh','/bin/dash','/bin/zsh','/bin/tcsh')<br>);<br>CREATE POLICY<br>Grant all the normal rights on the table to the admin user:<br>yugabyte=# GRANT SELECT, INSERT, UPDATE, DELETE ON passwd TO admin; GRANT<br>Page 104<br>Grant only select access on non-sensitive columns to everyone:<br>yugabyte=# GRANT SELECT<br>(user_name, uid, gid, real_name, home_phone, extra_info, home_dir, shell) ON<br>passwd TO public;<br>GRANT<br>Grant update to only the sensitive columns:<br>yugabyte=# GRANT UPDATE<br>(pwhash, real_name, home_phone, extra_info, shell) ON passwd TO public;<br>GRANT<br>Ensure that no one has been granted Bypass RLS inadvertently, by running the psql<br>display command \du+. If unauthorized users do have Bypass RLS granted then resolve<br>this using the ALTER ROLE <user> NOBYPASSRLS; command.<br>You can now verify that 'admin', 'bob', and 'alice' are properly restricted by querying the<br>passwd table as each of these roles.<br>
                        </div>
                    </div>
                </div>
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>4.6: Make use of predefined roles</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Review the list of all database roles that have superuser access and determine if one or
more of the predefined roles would suffice for the needs of that role:
yugabyte=# select rolname from pg_roles where rolsuper is true;
rolname
----------
postgres
yugabyte
(2 rows)
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            If you've determined that one or more of the predefined roles can be used, simply GRANT<br>it:<br>yugabyte=# GRANT pg_monitor TO yugabyte; GRANT ROLE<br>And then remove superuser from the account:<br>yugabyte=# ALTER ROLE yugabyte NOSUPERUSER; ALTER ROLE<br>yugabyte=# select rolname from pg_roles where rolsuper is true; rolname<br>yugabyte (1 row)<br>
                        </div>
                    </div>
                </div>
                </div>
            </div>
            <div class="section-summary">
                <div class="section-header" onclick="toggleSection(this)">
                    <h3>YugabyteDB Settings <span class="chevron">‚ñ∂</span></h3>
                    <div class="section-stats">
                        <div class="section-stat">Total: 9</div>
                        <div class="section-stat">Passed: 0</div>
                        <div class="section-stat">Failed: 4</div>
                        <div class="section-stat">Skipped: 0</div>
                        <div class="section-stat manual">Manual: 5</div>
                        <div class="section-stat">Pass Rate: 0.0%</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0.0%;"></div>
                    </div>
                </div>
                <div class="controls-container">
                    
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>7.1: Understanding attack vectors and runtime GFLAGs</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Review all configuration settings. Configure YugabyteDB logging to record all
modifications and changes to the RDBMS.
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            In the case of a changed parameter, the value is returned back to its default value. In<br>the case of a successful exploit of an already set runtime parameter then an analysis<br>must be carried out to determine the best approach in mitigating the risk to prevent<br>future exploitation.<br>
                        </div>
                    </div>
                </div>
                <div class="control fail">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>7.2: Ensure 'backend' runtime parameters are configured correctly</strong>
                        </div>
                        <div>
                            <span class="status-badge FAIL">FAIL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Insecure runtime parameter settings found: log_connections: off (should be on for auditing); log_disconnections: off (should be on for auditing)</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>All backend parameters configured securely</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>8 parameters found: ignore_system_indexes: off, jit_debugging_support: off, jit_profiling_support: off, log_connections: off, log_disconnections: off, post_auth_delay: 0 ... and 2 more</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">Issue the following command to verify the backend runtime parameters are configured
correctly:
yugabyte=# SELECT name, setting FROM pg_settings WHERE context IN
('backend','superuser-backend') ORDER BY 1;
name | setting
-----------------------+---------
ignore_system_indexes | off
jit_debugging_support | off
jit_profiling_support | off
log_connections | off
log_disconnections | off
post_auth_delay | 0
(6 rows)
Note: Effecting changes to these parameters can only be made at server start.
Therefore, a successful exploit may not be detected until after a server restart, e.g.,
during a maintenance window.
</div>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Once detected, the unauthorized/undesired change can be corrected by altering the<br>configuration file and executing a server restart. In the case where the parameter has<br>been specified on the command-line invocation of yb_ctl the restart invocation is<br>insufficient and an explicit stop and start must instead be made.<br>1. Query the view pg_settings and compare with previous query outputs for any<br>changes.<br>2. Review configuration files ysql_pg.conf and ysql_hba.conf and compare them<br>with previously archived file copies for any changes.<br>3. Examine the process output and look for parameters that were used at server<br>startup:<br>ps -few | grep -E '[p]ost' | grep -- '-[D]'<br>1. Examine the contents of $PGDATA/postmaster.opts<br>
                        </div>
                    </div>
                </div>
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>7.3: Ensure 'Postmaster' Runtime Parameters are Configured</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">The following parameters can only be set at server start by the owner of the
YugabyteDB server process and cluster, typically the UNIX user account yugabyte.
Therefore, all exploits require the successful compromise of either that UNIX account or
the postgres superuser account itself.
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Once detected, the unauthorized/undesired change can be corrected by editing the<br>altered configuration file and executing a server restart. In the case where the<br>parameter has been specified on the command-line invocation of pg_ctl the restart<br>invocation is insufficient and an explicit stop and start must instead be made.<br>Detecting a change is possible by one of the following methods:<br>1. Query the view pg_settings and compare with previous query outputs for any<br>changes<br>2. Review the configuration files ysql_pg.conf and ysql_hba.conf and compare<br>with previously archived file copies for any changes<br>3. Examine the process output and look for parameters that were used at server<br>startup:<br>ps -few | grep -E 'postgres' | grep -- '-[D]'<br>1. Examine the contents of $PGDATA/postmaster.opts<br>
                        </div>
                    </div>
                </div>
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>7.4: Ensure 'SIGHUP' Runtime Parameters are Configured</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">The following parameters can be set at any time, without interrupting the server, by the
owner of the postmaster server process and cluster (typically UNIX user account
yugabyte).
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Restore all values in the YugabyteDB configuration files and invoke the server to restart.<br>
                        </div>
                    </div>
                </div>
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>7.5: Ensure 'Superuser' Runtime Parameters are Configured</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">The following parameters can only be set at server start by the owner of the
YugabyteDB server process and cluster i.e. typically UNIX user account yugabyte.
Therefore, all exploits require the successful compromise of either that UNIX account or
the yugabyte superuser account itself.
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            The exploit is made in the configuration files. These changes are effected upon server<br>restart. Once detected, the unauthorized/undesired change can be made by editing the<br>altered configuration file and executing a server restart. In the case where the<br>parameter has been set on the command-line invocation of pg_ctl the restart invocation<br>is insufficient and an explicit stop and start must instead be made.<br>Detecting a change is possible by one of the following methods:<br>1. Query the view pg_settings and compare with previous query outputs for any<br>changes.<br>2. Review the configuration files ysql_pg.conf and ysql_hba.conf and compare<br>with previously archived file copies for any changes.<br>3. Examine the process output and look for parameters that were used at server<br>startup:<br>ps aux | grep -E 'post' | grep -- '-[D]'<br>1. Examine the contents of $PGDATA/postmaster.opts<br>
                        </div>
                    </div>
                </div>
                <div class="control manual">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>7.6: Ensure 'User' Runtime Parameters are Configured</strong>
                        </div>
                        <div>
                            <span class="status-badge MANUAL">MANUAL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>Manual control - requires manual verification</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">The method used to analyze the state of ROLE runtime parameters and to determine if
they have been compromised is to inspect all catalogs and list attributes for database
entities such as ROLEs and databases.
</div>
                        </div>
                        <div class="manual-verification">
                            <strong>Manual Verification Required:</strong><br>
                            <p>This control requires manual verification. Please consult the CIS benchmark documentation for detailed steps.</p>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            In the matter of a user session, the login sessions must be validated that it is not<br>executing undesired parameter changes. In the matter of attributes that have been<br>changed in entities, they must be manually reverted to their default value(s).<br>
                        </div>
                    </div>
                </div>
                <div class="control fail">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>7.7: Ensure TLS is enabled and configured correctly: server to server</strong>
                        </div>
                        <div>
                            <span class="status-badge FAIL">FAIL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>SSL/TLS is not enabled: off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>on</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">To determine whether TLS is enabled, simply query the parameter value while logged
into the database.
</div>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            Before you can enable and use server-to-server encryption, you need to create and<br>configure server certificates for each node of your YugabyteDB cluster. For information,<br>see: https://docs.yugabyte.com/preview/secure/tls-encryption/server-certificates/<br>To enable server-to-server encryption using TLS, start your YB-Master and YB-TServer<br>nodes using the following flags.<br>‚Ä¢ --use_node_to_node_encryption Set to true to enable encryption between<br>YugabyteDB nodes. Default value is false.<br>‚Ä¢ --allow_insecure_connections Set to false to disallow any service with<br>unencrypted communication from joining this cluster. Default value is true. Note<br>that this flag requires --use_node_to_node_encryption to be enabled.<br>‚Ä¢ --certs_for_client_dir Optional. Directory containing the certificates created<br>for this node to perform encrypted communication with the other nodes. Default<br>for YB-Masters is <data drive>/yb-data/master/data/certs and for YBTServers is <data drive>/yb-data/tserver/data/certs<br>You can enable access control by starting the yb-master services with the --<br>use_node_to_node_encryption=true flag as described above<br>
                        </div>
                    </div>
                </div>
                <div class="control fail">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>7.8: Ensure TLS is enabled and configured correctly: client to server</strong>
                        </div>
                        <div>
                            <span class="status-badge FAIL">FAIL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>SSL/TLS is not enabled for client connections: off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>on</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>off</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">To determine whether TLS is enabled, simply query the parameter value while logged
into the database.
yugabyte=# SHOW ssl;
ssl
-----
off
(1 row)
</div>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            To enable client-to-server encryption for YSQL and YCQL, start your YB-TServer<br>services with the required flags described below. Your YB-Master services do not<br>require additional configuration.<br>‚Ä¢ --use_client_to_server_encryption Set to true to enable encryption between<br>the various YugabyteDB clients and the database cluster. Default value is false.<br>‚Ä¢ --allow_insecure_connections Set to false to disallow any client with<br>unencrypted communication from joining this cluster. Default value is true. Note<br>that this flag requires --use_client_to_server_encryption to be enabled.<br>‚Ä¢ --certs_for_client_dir Optional. Defaults to the same directory as the serverto-server encryption. <br>This directory should contain the configuration for the client<br>to perform TLS communication with the cluster. Default value for YB-TServer is<br><data drive>/yb-data/tserver/data/certs.<br>To enable access control, follow these steps, start the yb-tserver services with the<br>following flag (described above):<br>--use_client_to_server_encryption=true<br>This flag enables both encrypted and unencrypted clients to connect to the cluster.<br>To prevent clients without the appropriate encryption from connecting, you must add the<br>following flag:<br>--allow_insecure_connections=false<br>Your command should look similar to this:<br>./bin/yb-tserver \<br>--fs_data_dirs=<data directories> \<br>--tserver_master_addrs=<master addresses> \<br>--certs_for_client_dir /home/centos/tls/$NODE_IP \<br>--allow_insecure_connections=false \<br>--use_client_to_server_encryption=true &<br>
                        </div>
                    </div>
                </div>
                <div class="control fail">
                    <div class="control-header" onclick="toggleControl(this)">
                        <div>
                            <strong>7.9: Ensure the pgcrypto extension is installed and configured correctly</strong>
                        </div>
                        <div>
                            <span class="status-badge FAIL">FAIL</span>
                            <span class="chevron">‚ñ∂</span>
                        </div>
                    </div>
                    <div class="control-body">
                        <div class="detail-row">
                            <span class="detail-label">Message:</span>
                            <span>pgcrypto extension is available but not installed. name: pgcrypto, default_version: 1.3, comment: cryptographic functions</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Profile Level:</span>
                            <span>Level 1 - Yugabyte</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Expected:</span>
                            <span>pgcrypto installed for data encryption</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Actual:</span>
                            <span>installed_version: NULL, name: pgcrypto, default_version: 1.3, comment: cryptographic functions</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Audit Command:</span>
                            <div class="audit-cmd">One possible way to encrypt data within YugabyeDB is to use the pgcrypto extension.
To check if pgcrypto is installed on YugabyteDB, as a database administrator run the
following commands:
yugabyte=# SELECT * FROM pg_available_extensions WHERE name='pgcrypto';
name | default_version | installed_version | comment
----------+-----------------+-------------------+-------------------------
pgcrypto | 1.3 | | cryptographic functions
(1 row)
If data in the database requires encryption and pgcrypto is not available, this is a fail.
If disk or filesystem requires encryption, ask the system owner, DBA, and SA to
demonstrate the use of disk-level encryption. If this is required and is not found, this is a
fail. If controls do not exist or are not enabled, this is also a fail.
</div>
                        </div>
                        <div class="remediation">
                            <strong>Remediation:</strong><br>
                            The pgcrypto extension is included with the YugabyteDB 'contrib' package. Although<br>included, it needs to be created in the database.<br>As the database administrator, run the following:<br>yugabyte=# CREATE EXTENSION pgcrypto;<br>Verify pgcrypto is installed:<br>yugabyte=# SELECT * FROM pg_available_extensions WHERE name='pgcrypto';<br>name | default_version | installed_version | comment<br>----------+-----------------+-------------------+-------------------------<br>pgcrypto | 1.3 | 1.3 | cryptographic functions<br>(1 row)<br>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        
    </div>
    
    <script>
        function toggleSection(element) {
            console.log('toggleSection called');
            const container = element.parentElement.querySelector('.controls-container');
            const chevron = element.querySelector('.chevron');

            if (container && chevron) {
                container.classList.toggle('expanded');
                chevron.classList.toggle('rotated');
                console.log('Section toggled:', container.classList.contains('expanded'));
            } else {
                console.error('Could not find container or chevron');
            }
        }

        function toggleControl(element) {
            console.log('toggleControl called');
            const body = element.nextElementSibling;
            const chevron = element.querySelector('.chevron');

            if (body && chevron) {
                body.classList.toggle('expanded');
                chevron.classList.toggle('rotated');
                console.log('Control toggled:', body.classList.contains('expanded'));
            } else {
                console.error('Could not find body or chevron');
            }
        }

        // Auto-expand failed sections with animation
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, setting up sections');
            
            const failedSections = document.querySelectorAll('.section-summary');
            console.log('Found sections:', failedSections.length);
            
            failedSections.forEach((section, index) => {
                const failedControls = section.querySelectorAll('.control.fail');
                const manualControls = section.querySelectorAll('.control.manual');
                
                if (failedControls.length > 0 || manualControls.length > 0) {
                    setTimeout(() => {
                        const header = section.querySelector('.section-header');
                        if (header) {
                            console.log('Auto-expanding section:', header.textContent);
                            toggleSection(header);
                        }
                    }, index * 200); // Stagger the animations
                }
            });

            // Add smooth scrolling to all internal links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth'
                        });
                    }
                });
            });
        });

        // Add keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                // Close all expanded sections
                document.querySelectorAll('.controls-container.expanded').forEach(container => {
                    const header = container.previousElementSibling;
                    toggleSection(header);
                });

                document.querySelectorAll('.control-body.expanded').forEach(body => {
                    const header = body.previousElementSibling;
                    toggleControl(header);
                });
            }
        });
    </script>
</body>
</html>